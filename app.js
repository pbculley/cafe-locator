var express = require("express");
var app = express(); 
var path = require("path"); 
var yelp = require("yelp-fusion");
var request = require("request");
var bodyParser = require("body-parser");

app.use(express.static(__dirname + '/public')); 
app.use(bodyParser.urlencoded({extended: true}));
app.set("view engine", "ejs");

var cafes = [
		{name: "cafe 1", image: "data:image/jpeg;base64,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"},
		{name: "cafe 1", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQHHrx8cbwNmEh0-NxIPkeqk7V6pAZmEEu326pDQ9MoaOCEa1Tw"},
		{name: "cafe 1", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTsY4jF771Oi5fzXJpDe__03avc2sS5y22c2Q57UkOT5eDFkPPW"}
];

var location = cafes[0].image;

let client = yelp.client("wvgTbG0vFrnfDXLftB1LhfurlDZmbsl3WhvaPaJEd0lAeUDnbqiT1kyilHsFw88S4U28E4Ywlu_vLm7PnUqcq_P4zl6aKB5SL14cMHq3GfVX9gIe25WXOho8srMEXHYx"); 

app.get("/", function(req,res){
	res.render("landing",{location:location});
});

app.post("/", async function(req, res){
 client.search({
  term: 'punk',
  location: req.body.location, 
  limit: 10
}).then(response => {
	var businesses = response.jsonBody.businesses;
	var imgArr = []; 
	var coNameArr = []; 
	var hourArr = []; 
	var idArray = [];  
	var openHours; 
	var id = businesses.forEach(el => {
		idArray.push(el.id); 
		});
	var imgs = businesses.map(foo => {
		imgArr.push(foo.image_url); 
		});
	var coName = businesses.map(el => {
		coNameArr.push(el.name);
		});
	var searchResults = {
		name: coNameArr,
		location: [], 
		imgs: imgArr,
		displayPhone: [],
		hour: openHours
	}
	var delay = 1 * 1000;
	var fuck;

		function findDay(y){
			var dayArr = ["Mon", "Tues", "Wed", "Thurs", "Fri", "Sat", "Sun",]; 
			return dayArr[y]; 
			 }

		function findTime(x){
			var pm = "" + (x - 1200);
			var am = "" + x; 
			if(x == 1200){
				return "12:00 p.m"; 
			}
			if( x >= 1200){
				return pm.replace(/00$/, ":") + pm.slice(-2) + " p.m";
			}
				return am.replace(/00$/, ":") + am.slice(-2) + " a.m.";
			}

	for(var x = 0; x < businesses.length; x++){
		searchResults.location.push(businesses[x].location['display_address']); 
		searchResults.displayPhone.push(businesses[x].display_phone);
	}	
	var fuck = "DIPSHIT"
	var fuckthisbullshit = new Promise(function(resolve, reject){
		setTimeout(() => 
			resolve(fuck),2000);
	});
	fuckthisbullshit.then((result, error) => 
		console.log(result),
		error => console.log(error));
	
		// setTimeout(function(x){
		// 	client.business(idArray[x]).then(response => {
		// 	var hours = response.jsonBody.hours.map(el => {
		// 		return el.open;
		// 	});
		// 	openHours = hours.map(lo => {
		// 		for(var x = 0; x < lo.length; x++){
		// 			return lo.map(hrs => {
		// 				var start = Number(hrs.start); 
		// 				var end = Number(hrs.end);
		// 			return findDay(hrs.day) + " " + findTime(hrs.start) + " - " + findTime(hrs.end); 
		// 			}); 
		// 		}
		// 	});	
		// 	console.log(openHours); 
		// 	});  
	
		// },delay*x,x)
	

	res.render('search', {
		imgArr:imgArr,
		searchResults:searchResults,
		hour: fuck
	});
}).catch(e => {
  console.log(e);
});
});

app.get("/cafes", function(req,res){
	res.render("cafes", {cafes:cafes});
});
app.post("/cafes", function(req,res){
	var name = req.body.name;
	var image = req.body.image;
	var newCafe = {
		name: name, 
		image: image
	}
}
)

app.get("/cafes/new", function(req,res){
	res.render("new.ejs")
})
app.listen(3000);








	






